(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{1133:function(e,t,s){"use strict";s.r(t),s.d(t,"LikertRenderer",(function(){return I}));var i=s(2),o=s(0),n=s(3),a=s(6),r=s(10),c=s(15),l=s(107),u=s(34),d=s(39),h=s(9),p=s(12),m=s(131),f=s(66),b=s(118),M=s(11),C=s(18),g=function(e){function t(t){var s=e.call(this,t)||this;return s.rootRef=o.createRef(),s.onQuestionChangeCallback=function(){return s.forceUpdate()},s.state={FocusedIndex:-1},s.expandWhenFocus=s.expandWhenFocus.bind(s),s.onValueChange=s.onValueChange.bind(s),s.lostFocus=s.lostFocus.bind(s),s.onAnswerChangeCallback=s.onAnswerChangeCallback.bind(s),s.isHidden=!1,s}Object(i.__extends)(t,e);var s=t.prototype;return s.componentWillMount=function(){this.props.Disabled||this.props.QuestionRuntimeMasterClass.observe(this.onAnswerChangeCallback,[b.a.Schema.Answer]);var e=[];e=Object(d.b)(e),this.props.QuestionMasterClass.Form.observe(this.onQuestionChangeCallback,e),this.props.QuestionMasterClass.observe(this.onQuestionChangeCallback,[Object(p.i)().Schema.Title]),this.props.LocaleId&&this.updateQuestionLocalizedItemMaster(this.props.LocaleId,this.props.QuestionMasterClass.Model.Id,this.props.QuestionMasterClass.Form)},s.componentWillReceiveProps=function(e){this.updateQuestionLocalizedItemMaster(e.LocaleId,e.QuestionMasterClass.Model.Id,e.QuestionMasterClass.Form)},s.componentWillUnmount=function(){this.props.QuestionRuntimeMasterClass&&this.props.QuestionRuntimeMasterClass.unobserve(this.onQuestionChangeCallback),this.props.QuestionMasterClass.Form.unobserve(this.onQuestionChangeCallback),this.props.QuestionMasterClass.unobserve(this.onQuestionChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.onQuestionChangeCallback)},s.render=function(){var e,t=this.props.QuestionMasterClass,s=this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.title||t.Model.Title;return Object(r.i)()&&(s=(null===(e=this.questionLocalizedItemMaster)||void 0===e?void 0:e.Model.formsprortlocaletitle)||t.Model.FormsProRTQuestionTitle||s),this.props.PadView?o.createElement("div",{className:"office-form-mobile-matrix-points",onBlur:this.lostFocus,onFocus:this.expandWhenFocus,ref:this.rootRef},this.createMobileQuestionRow(s)):o.createElement("tr",{"aria-labelledby":this.getSubLabelId(this.props.QuestionIndex),className:"office-form-matrix-str",role:"radiogroup",hidden:this.isHidden},this.createQuestionRow(s))},s.onAnswerChangeCallback=function(){this.props.QuestionMasterClass.Model.Required?this.props.UpdateTopQuestion():this.forceUpdate()},s.updateQuestionLocalizedItemMaster=function(e,t,s){this.questionLocalizedItemMaster&&(this.props.QuestionMasterClass.unobserve(this.onQuestionChangeCallback),this.questionLocalizedItemMaster=void 0),e&&(this.questionLocalizedItemMaster=f.a.getQuestionResourceMaster(e,t,s),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.onQuestionChangeCallback,[l.a.Schema.title]))},s.expandWhenFocus=function(e){this.props.IsExpanded||this.props.onChange(this.props.QuestionIndex,!0);var t=e.target;this.setState({FocusedIndex:parseInt(t.value,10)})},s.lostFocus=function(e){var t=e.relatedTarget,s=this.rootRef.current;s&&!s.contains(t)&&this.setState({FocusedIndex:-1})},s.createQuestionRow=function(e){var t=this,s=[],i={Text:e=Object(d.m)(e,!1)};Object(r.i)()&&(i.RenderMode="RichText",i.ContainsHtml=!0);var a=o.createElement("span",{className:"office-form-matrix-subquestion",id:this.getSubLabelId(this.props.QuestionIndex)},Object(u.b)(i)),c=o.createElement("td",{className:"office-form-matrix-std",key:"subQuestionTitle",role:"presentation"},a);s.push(c);var l=n.map(this.props.Choices,(function(e,s){var i=!1;if(!t.props.ShowDesignInfo){var o=t.props.QuestionRuntimeMasterClass&&t.props.QuestionRuntimeMasterClass.Model.Answer;i=o&&n.isEqual(o.id,e.Id)}return t.createMatrixRadio(t.props.QuestionMasterClass.Model.Id,s,!!i)}));return s=s.concat(l)},s.createMatrixRadio=function(e,s,i){var n=this.props,a=n.Disabled,c=n.Choices,l=n.PadView,d="subquestion-radio-"+e,p=this.getLabelId(s),m=Object(r.i)(),f=o.createElement("input",{"aria-checked":i,"aria-labelledby":p,"aria-posinset":s+1,"aria-setsize":c.length,checked:i,disabled:a,name:d,onChange:a?void 0:this.onValueChange,type:"radio",value:s,role:"radio"});if(l){var b=this.getLocalizedDescription(c[s],m),M=Object(h.b)("office-form-question-matrix-choice","office-form-theme-page-background-active",i?"active":""),C=Object(h.b)("radio-icon "+(this.state.FocusedIndex===s?"focused":""),"ms-Icon ms-Icon--"+(i?"RadioBtnOn":"RadioBtnOff"),a?"disabled":"");return o.createElement("li",{key:s,className:M,role:"listitem"},o.createElement("label",{className:"office-form-question-matrix-choice-row"},f,o.createElement("i",{className:C,"aria-hidden":"true"}),o.createElement("span",{className:"office-form-question-matrix-choice-text",id:p},o.createElement(u.a,{Text:b,RenderMode:m?"RichText":void 0,ContainsHtml:m}))))}return o.createElement("td",{className:"office-form-matrix-radio",key:s,onClick:t.enlargeClickArea,role:"presentation"},o.createElement("label",{className:"office-form-matrix-label"},f))},t.enlargeClickArea=function(e){var t=e.target;t===e.currentTarget&&t.firstChild.click()},s.getLabelId=function(e){var t=this;return Object(M.c)((function(){return t.props.QuestionOrdinal+"-col-"+(e+1)}),M.f)},s.createMobileQuestionRow=function(e){var t=this,s=this.props,i=s.QuestionMasterClass,a=s.Choices,c=s.QuestionRuntimeMasterClass,l=s.QuestionIndex,u=-1,d=n.map(a,(function(e,s){var o=!1;if(!t.props.ShowDesignInfo){var a=c&&c.Model.Answer;o=a&&n.isEqual(a.id,e.Id)}return o&&(u=s),t.createMatrixRadio(i.Model.Id,s,o)})),h=o.createElement("ul",{className:"office-form-mobile-matrix-choices",key:"choicelist",role:"radiogroup"},d),p=Object(r.i)(),m=-1!==u?this.getLocalizedDescription(a[u],p):"";return[this.createQuestionTitle(e,m,l,p),h]},s.getSubLabelId=function(e){return this.props.QuestionOrdinal+"-row-"+(e+1)},s.createQuestionTitle=function(e,t,s,n){var a=this,c={className:"office-form-mobile-matrix-title",id:this.getSubLabelId(s),key:"subquestion-title",onClick:this.props.PadView?function(){return a.props.onChange(s,!a.props.IsExpanded)}:void 0,ref:function(e){if(e){var t=e.parentElement,s=e.offsetHeight;a.props.IsExpanded&&(s+=e.nextElementSibling.offsetHeight),t&&(t.style.height=s+"px")}}},l={Text:e};return Object(r.i)()&&(l.RenderMode="RichText",l.ContainsHtml=!0),o.createElement("div",Object(i.__assign)({},c),o.createElement("div",{className:"office-form-mobile-matrix-title-header"},o.createElement("span",null,Object(u.b)(l)),o.createElement(C.a,{HTMLAttributes:{className:"select-dropdown-arrow forms-icon-size20x20"},IconName:this.props.IsExpanded?"ChevronUp":"ChevronDown"})),o.createElement("div",{className:"office-form-mobile-matrix-answered-indicator"},o.createElement(u.a,{Text:t,RenderMode:n?"RichText":void 0,ContainsHtml:n})))},s.onValueChange=function(e){var t=this.props.QuestionRuntimeMasterClass,s=e.currentTarget,i=this.props.Choices[parseInt(s.value,10)],o=Object(m.b)(i);if(o.isFieldReady(o.Schema.Id)){var n=s.checked?{id:i.Id}:void 0;t&&(this.props.PadView&&this.props.onChange(this.props.QuestionIndex+1,!0),t.Model.Answer=n)}},s.getLocalizedDescription=function(e,t){var s=this.props.LocalizedChoices;if(null==s?void 0:s.length){var i=n.find(s,(function(t){return t.choiceId===e.Id.toString()}));if(null==i?void 0:i.description)return i.description}return t&&e.FormsProDisplayRTText||e.Description},t}(s(8).a),I=function(e){function t(t){var s=e.call(this,t)||this;return s.state={IsSubQuestionsExpanded:[!t.Disabled]},s.updateTopQuestion=s.updateTopQuestion.bind(s),s}Object(i.__extends)(t,e);var s=t.prototype;return s.componentWillMount=function(){var t=this;e.prototype.componentWillMount.call(this);var s=this.props.Master;this.onSubQuestionListChangeCallback=function(e){return t.onSubQuestionListChange(e)},a.a.getCollectionMasterFromModel(s.Question.Form.Model.Questions).observe(this.onSubQuestionListChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[l.a.Schema.choices])},s.componentWillUnmount=function(){a.a.getCollectionMasterFromModel(this.props.Master.Question.Form.Model.Questions).unobserve(this.onSubQuestionListChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),e.prototype.componentWillUnmount.call(this)},s.createReactNodes=function(){var e,t=this.createSubQuestionsLayout();if(this.showPadView()){var s=this.getElementProps({className:"office-form-mobile-matrix-container",key:"Likert",role:"list"});e=o.createElement("div",Object(i.__assign)({},s),t)}else{var n=this.createHeaderLine();e=o.createElement("div",{className:"office-form-matrix-table",key:"Likert"},o.createElement("table",Object(i.__assign)({},this.getElementProps(),{role:"group"}),n,o.createElement("tbody",{className:"office-form-matrix-stbody"},t)))}return[e]},s.onSubQuestionListChange=function(e){var t=this.props.Master;e.AddedModels.concat(a.a.convertToArray(e.RemovedModels)).map(a.a.getObjectMasterFromModel).some((function(e){return e.Model.GroupId===t.Question.Model.Id}))&&this.forceUpdate()},s.createHeaderLine=function(){var e,t=this,s=this.props.Master.Question.Model,a=this.questionLocalizedItemMaster,c=o.createElement("td",{className:"office-form-matrix-ptd",key:"emptyTd"}),l={className:"office-form-matrix-ptd",width:"width:calc((100% - 180px)/"+s.ChoiceGroup.length+")"},d=s.ChoiceGroup;return e=n.map(d,(function(e,s){var c;a&&a.Model.choices.length&&(c=n.find(a.Model.choices,(function(t){return t.choiceId===e.Id.toString()})));var d=c&&c.description||Object(r.i)()&&e.FormsProDisplayRTText||e.Description,h={RenderMode:Object(r.i)()?"RichText":void 0,Text:d};return Object(r.i)()&&(h.ContainsHtml=!0),o.createElement("td",Object(i.__assign)({},l,{key:s,id:t.getLabelId(s)}),o.createElement("span",null,Object(u.b)(h)))})),o.createElement("thead",{className:"office-form-matrix-pthead"},o.createElement("tr",{className:"office-form-matrix-ptr"},c,e))},s.createSubQuestionsLayout=function(){var e,t,s=this,a=this.props.Master,r=a.Question.Model.ChoiceGroup,c=a.SubQuestions,l=this.showPadView(),u=this.questionLocalizedItemMaster;if(u){var d=u.Model;e=d.localeId,t=d.choices}return n.map(c,(function(n,c){var u={Choices:r,Disabled:s.props.Disabled,IsExpanded:s.state.IsSubQuestionsExpanded[c],LocaleId:e||"",LocalizedChoices:t,onChange:function(e,t){return s.questionExpandedChange(e,t)},PadView:!!l,QuestionIndex:c,QuestionMasterClass:n,QuestionOrdinal:s.getQuestionId(),QuestionRuntimeMasterClass:a.getSubQuestionRuntimeById(n.Model.Id),ShowDesignInfo:!!s.props.ShowDesignInfo,UpdateTopQuestion:s.updateTopQuestion};return o.createElement(g,Object(i.__assign)({},u,{key:n.getInstanceId()}))}))},s.updateTopQuestion=function(){this.update()},s.showPadView=function(){return this.props.IsMobile||!this.props.ShowDesignInfo&&Object(c.A)()},s.questionExpandedChange=function(e,t){var s=[];e<this.props.Master.SubQuestions.length&&(s[e]=t),this.setState({IsSubQuestionsExpanded:s})},s.getLabelId=function(e){return this.getQuestionId()+"-col-"+(e+1)},t}(s(210).a)}}]);