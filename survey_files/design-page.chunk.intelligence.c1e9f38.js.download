(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{370:function(e,t,n){"use strict";n.r(t),n.d(t,"UserInteractionQuestionSuggestionV2",(function(){return r}));var s=n(2),i=n(0),o=n(9),a=n(18),r=function(e){function t(t){var n=e.call(this,t)||this;return n.onMouseEnterQuestion=n.onMouseEnterQuestion.bind(n),n.onMouseLeaveQuestion=n.onMouseLeaveQuestion.bind(n),n.onSelect=n.onSelect.bind(n),n.state={IsHover:!1,WillUnmount:!1},n}Object(s.__extends)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){window.clearTimeout(this.disappearTimer)},n.render=function(){var e,t=this.props.Question,n=t.QuestionTagForIntelligence,r="form-intelligence-question-row",g="forms-icon-size18x18";if(this.props.Selected)r=Object(o.b)(r,"office-form-intelligence-theme-li"),g="office-form-theme-secondary-color",e="CheckMark";else switch(t.Type){case"Question.Choice":e="RadioBtnOn",g="forms-icon-size16x16";break;case"Question.TextField":e="TextField",g="forms-icon-size20x20";break;case"Question.Rating":e="Like";break;case"Question.DateTime":e="Calendar";break;case"Question.Ranking":e="Sort";break;case"Question.MatrixChoiceGroup":e="ViewList";break;case"Question.NPS":e="AutoRacing",g="forms-icon-size20x20";break;case"Question.FileUpload":e="Upload";break;default:e="Add"}g=Object(o.b)(g,"form-intelligence-icon-black"),g=Object(o.b)(g,"form-intelligence-question-row-icon");var u={className:r,key:"formIntelligenceRow"+n,onClick:this.onSelect,ref:"formIntelligenceRow"+n,tabIndex:0},l=i.createElement("p",{className:"form-intelligence-question-row-text"},t.Title),c="form-intelligence-question-row-container";this.state.WillUnmount&&(c="form-intelligence-question-row-container-hide form-intelligence-question-row-container-disappear");var d=Object(a.b)({HTMLAttributes:{className:g},IconName:e});return i.createElement("div",{className:c,key:"formIntelligenceRowContainer"+n,onMouseEnter:this.onMouseEnterQuestion,onMouseLeave:this.onMouseLeaveQuestion},i.createElement("div",Object(s.__assign)({},u),l,d))},n.onMouseEnterQuestion=function(){this.setState({IsHover:!0})},n.onMouseLeaveQuestion=function(){this.setState({IsHover:!1})},n.onSelect=function(){this.props.updateSelectedSuggestion(this.props.Index,this.props.Selected)},t}(n(8).a)},371:function(e,t,n){"use strict";n.r(t),n.d(t,"ShareAssistantCard",(function(){return p}));var s=n(2),i=n(0),o=n(10),a=n(1),r=n(9),g=n(175),u=n(159),l=n(5),c=n(18),d=n(17),h=n(128),m=n(26),S=n(69),p=function(e){function t(t){var n=e.call(this,t)||this;return n.responseTimeEstimationInterval=1e3,n.recommendResponseTime=5,n.regex=new RegExp(Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Description.format("(\\d)*")),n.shareAssistantRef=i.createRef(),n.predictResponseTime=n.predictResponseTime.bind(n),n.onClickInsertResponseTimeEstimationButton=n.onClickInsertResponseTimeEstimationButton.bind(n),n.onClickCloseResponseTimeEstimationButton=n.onClickCloseResponseTimeEstimationButton.bind(n),n.onClickBranchingCloseButton=n.onClickBranchingCloseButton.bind(n),n.onDismiss=n.onDismiss.bind(n),n.onClickExpandTip=n.onClickExpandTip.bind(n),n.onMouseEnterTip=n.onMouseEnterTip.bind(n),n.onMouseLeaveTip=n.onMouseLeaveTip.bind(n),n.onKeyUpCloseTip=n.onKeyUpCloseTip.bind(n),n.onKeyUpExpandTip=n.onKeyUpExpandTip.bind(n),n.onSuggestionChanged=n.onSuggestionChanged.bind(n),Object(o.c)("PersonalContextSuggestion")&&(n.intelligenceSuggestionsMaster=Object(u.a)(n.props.Form)),n.state={HasFocused:!1,HasReminded:!1,HasResponseTimePrediction:!1,IsAdded:n.regex.test(n.props.Form.Model.Description),IsCloseTip:!1,IsShowCard:!n.props.Form.Model.HasValidBranching,ResponseTimePrediction:0,ShowCloseButton:!1},n}Object(s.__extends)(t,e);var n=t.prototype;return n.componentWillMount=function(){var e=this,t=this.props.Form;Object(o.c)("PersonalContextSuggestion")?this.intelligenceSuggestionsMaster.observe(this.onSuggestionChanged,[this.intelligenceSuggestionsMaster.Schema.SuggestionId]):(t.observe(this.predictResponseTime,[t.Schema.Description,t.Schema.Questions,t.Schema.Title]),t.ensureReadyToDesign().then((function(){e.predictResponseTime()})))},n.componentDidUpdate=function(){var e=Object(o.c)("UserInterationSuggestionCard")&&$("#form-intelligence-question-suggestion-card").length;!this.shareAssistantRef.current||this.state.HasFocused||e?!this.shareAssistantRef.current&&this.state.HasFocused&&this.setState({HasFocused:!1}):(this.shareAssistantRef.current.focus(),this.setState({HasFocused:!0}))},n.componentWillUnmount=function(){window.clearTimeout(this.responseTimeEstimationTimeout),Object(o.c)("PersonalContextSuggestion")?this.intelligenceSuggestionsMaster.unobserve(this.onSuggestionChanged):this.props.Form.unobserve(this.predictResponseTime)},n.render=function(){return this.state.HasResponseTimePrediction&&!this.props.Form.SettingMaster.Model.IsQuizMode&&this.props.Form.Model.Questions.length>0&&this.state.ResponseTimePrediction>=3&&!this.state.IsCloseTip?(T("Intelligence.PredictResponseTime.Show","Seen"),this.state.IsShowCard&&!this.props.Form.Model.HasValidBranching?i.createElement("div",{className:"estimate-response-time-container"},this.createShareAssistantHeader(),this.createResponseTimeEstimationDescription(),this.createResponseTimeEstimationButton()):i.createElement("div",null,this.createEstimateResponseTimeTip())):null},n.createShareAssistantHeader=function(){var e=Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Suggestion.format(this.state.ResponseTimePrediction),t=Object(r.i)(e);return i.createElement("div",{className:"estimate-response-time-estimation-container"},i.createElement(c.a,{HTMLAttributes:{className:"forms-icon-size12x12 estimate-response-time-estimation-icon"},IconName:"Clock"}),i.createElement(h.a,{Role:"Log",LazyRendering:!0},i.createElement("div",{className:"estimate-response-time-estimation-title",dangerouslySetInnerHTML:{__html:t}})))},n.createResponseTimeEstimationDescription=function(){if(!this.state.HasResponseTimePrediction)return null;var e=Object(a.a)().Share_Assistant_Card_Description_1;return this.state.ResponseTimePrediction>this.recommendResponseTime&&(e=this.state.IsAdded?Object(a.a)().Share_Assistant_Card_Description_3:Object(a.a)().Share_Assistant_Card_Description_2),i.createElement("div",{className:"estimate-response-time-description"},i.createElement(h.a,{Role:"Log",LazyRendering:!0},e))},n.createResponseTimeEstimationButton=function(){var e=this.state.IsAdded?Object(a.a)().Share_Assistant_Card_Button_Update:Object(a.a)().Share_Assistant_Card_Button_Add,t=Object(a.a)().Share_Assistant_Card_Button_Got_It,n={ButtonStyle:"None",HTMLAttributes:{className:"estimate-response-time-button-got-it",onClick:this.onDismiss,"aria-label":t},Text:t},o=this.state.IsAdded||this.state.ResponseTimePrediction<=this.recommendResponseTime?i.createElement(m.a,{ButtonStyle:"LightBackground",HTMLAttributes:{className:"estimate-response-time-button-add",onClick:this.onClickInsertResponseTimeEstimationButton,"aria-label":e},ref:this.shareAssistantRef,Text:e}):null;return i.createElement("div",{className:"estimate-response-time-button-container"},o,i.createElement(m.a,Object(s.__assign)({},n)))},n.createEstimateResponseTimeTip=function(){var e=this.props.Form.Model.HasValidBranching,t=Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Tip_Minutes,n=Object(d.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"estimate-response-time-button-close",onClick:this.onClickCloseResponseTimeEstimationButton,onKeyUp:this.onKeyUpCloseTip,onBlur:this.onMouseLeaveTip,"aria-label":Object(a.a)().Common_Close_Text},Icon:"ChromeClose",IconClassName:"forms-icon-size10x10"}),s=e?"estimate-response-time-tip-container-opacity":"estimate-response-time-tip-container";return i.createElement("div",{className:s,onMouseEnter:e?null:this.onMouseEnterTip,onMouseLeave:e?null:this.onMouseLeaveTip,tabIndex:-1},i.createElement("div",{className:"estimate-response-time-tip-number",onClick:e?null:this.onClickExpandTip,onFocus:e?null:this.onMouseEnterTip,onKeyUp:e?null:this.onKeyUpExpandTip,tabIndex:e?-1:0,"aria-hidden":e,role:"button","aria-expanded":e?null:"false","aria-label":e?null:this.state.ResponseTimePrediction+t},i.createElement("b",null,this.state.ResponseTimePrediction),t),this.state.ShowCloseButton&&!e&&i.createElement("div",{className:"estimate-response-time-tip-close"},n),e&&i.createElement("div",null,this.createBranchingTip()))},n.onClickCloseResponseTimeEstimationButton=function(){this.setState({IsCloseTip:!0}),T("Intelligence.PredictResponseTime.Close","Closed",!0)},n.onClickBranchingCloseButton=function(){this.setState({IsCloseTip:!0}),T("Intelligence.PredictResponseTime.BranchingClose","Closed",!0)},n.createBranchingTip=function(){var e=Object(a.a)().Share_Assistant_Card_Button_Got_It,t=Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Branching_Tip_Title,n=this.state.IsAdded?Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Branching_Tip_Description_1:Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Branching_Tip_Description_2,o={ButtonStyle:"None",HTMLAttributes:{className:"estimate-response-time-branching-tip-button",onClick:this.onClickBranchingCloseButton,"aria-label":e},Text:e};return i.createElement("div",{className:"estimate-response-time-branching-tip-container"},i.createElement("div",{className:"estimate-response-time-branching-tip"},i.createElement("div",{className:"estimate-response-time-branching-tip-title","aria-live":"polite"},t),i.createElement("div",{className:"estimate-response-time-branching-tip-content"},n),i.createElement("div",{className:"estimate-response-time-branching-tip-button-container"},i.createElement(m.a,Object(s.__assign)({},o)))),i.createElement("div",{className:"estimate-response-time-branching-tip-arrow"}))},n.predictResponseTime=function(){var e=this;window.clearTimeout(this.responseTimeEstimationTimeout),this.setState({IsAdded:this.regex.test(this.props.Form.Model.Description)}),this.responseTimeEstimationTimeout=window.setTimeout((function(){S.a.predictResponseTime(e.props.Form).then((function(t){if(t){var n=Math.ceil(t.EstimatedTimeInSeconds/60);!e.state.HasReminded&&n>e.recommendResponseTime&&e.setState({HasReminded:!0,IsShowCard:!0}),e.setState({HasResponseTimePrediction:!0,ResponseTimePrediction:n})}}))}),this.responseTimeEstimationInterval)},n.onClickInsertResponseTimeEstimationButton=function(){var e=this,t=Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Description.format(this.state.ResponseTimePrediction);this.props.Form.Model.Description?this.regex.test(this.props.Form.Model.Description)?this.props.Form.Model.Description=this.props.Form.Model.Description.replace(this.regex,t):this.props.Form.Model.Description=t+"\n"+this.props.Form.Model.Description:this.props.Form.Model.Description=t,T(this.state.IsAdded?"Intelligence.PredictResponseTime.Update":"Intelligence.PredictResponseTime.Add","Clicked",!0);$("#body-scrollable-content").animate({scrollTop:0},300),this.setState({IsAdded:!0,IsShowCard:!1,ShowCloseButton:!1},(function(){Object(o.c)("PersonalContextSuggestion")&&e.intelligenceSuggestionsMaster.AddDismissedSuggestion("PredictResponseTime")}))},n.onDismiss=function(){var e=this;T("Intelligence.PredictResponseTime.GotIt","Clicked",!0),this.setState({IsShowCard:!1,ShowCloseButton:!1},(function(){Object(o.c)("PersonalContextSuggestion")&&e.intelligenceSuggestionsMaster.AddDismissedSuggestion("PredictResponseTime")}))},n.onClickExpandTip=function(){var e=this;this.setState({IsShowCard:!0},(function(){Object(o.c)("PersonalContextSuggestion")&&e.intelligenceSuggestionsMaster.AddCurrentSuggestion("PredictResponseTime")}))},n.onMouseEnterTip=function(){this.setState({ShowCloseButton:!0})},n.onMouseLeaveTip=function(){this.setState({ShowCloseButton:!1})},n.onKeyUpExpandTip=function(e){switch(e.keyCode){case 13:case 32:e.stopPropagation(),this.onClickExpandTip()}},n.onKeyUpCloseTip=function(e){switch(e.keyCode){case 13:case 32:e.preventDefault(),this.onClickCloseResponseTimeEstimationButton()}},n.onSuggestionChanged=function(){var e=this,t=this.intelligenceSuggestionsMaster.getSuggestion("PredictResponseTime"),n=this.intelligenceSuggestionsMaster.ShouldPopUpSuggestion("PredictResponseTime");if(t){var s=t.Suggestion,i=Math.ceil(s.EstimatedTimeInSeconds/60);this.setState({HasResponseTimePrediction:!0,ResponseTimePrediction:i,IsShowCard:n},(function(){n&&e.intelligenceSuggestionsMaster.AddCurrentSuggestion("PredictResponseTime")}))}else this.setState({HasResponseTimePrediction:!1,IsShowCard:!1})},t}(n(8).a);function T(e,t,n){void 0===n&&(n=!1),Object(g.a)().initialize().then((function(s){Object(o.c)("EstimationTimeExp")&&s.EstimationTimeExperiment&&n&&Object(g.a)().track("EstimationTimeExperiment",t),Object(l.b)(e,{variation:s.EstimationTimeExperiment})}))}},372:function(e,t,n){"use strict";n.r(t),n.d(t,"ThemeSuggestionCard",(function(){return p}));var s=n(2),i=n(0),o=n(10),a=n(1),r=n(12),g=n(240),u=n(29),l=n(159),c=n(5),d=n(17),h=n(26),m=n(8),S=n(248),p=function(e){function t(t){var n=e.call(this,t)||this;n.mounted=!0,n.uxStateMaster=Object(r.b)(),n.expandThemeFlexPane=n.expandThemeFlexPane.bind(n),n.onSuggestionChange=n.onSuggestionChange.bind(n);var s=!1;return Object(o.c)("PersonalContextSuggestion")&&(n.intelligenceSuggestionsMaster=Object(l.a)(n.props.FormMaster),n.intelligenceSuggestionsMaster.observe(n.onSuggestionChange,[n.intelligenceSuggestionsMaster.Schema.SuggestionId]),s=n.intelligenceSuggestionsMaster.ShouldPopUpSuggestion("TitleSuggestsTheme")),n.state={ShowThemeSuggestionCard:s,Suggestions:[]},n}Object(s.__extends)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.onSuggestionChange()},n.componentWillUnmount=function(){this.mounted=!1,Object(o.c)("PersonalContextSuggestion")&&this.intelligenceSuggestionsMaster.unobserve(this.onSuggestionChange)},n.render=function(){return!this.state.ShowThemeSuggestionCard||!this.state.Suggestions||this.state.Suggestions.length<=0?null:(this.logSuggestionSeen(),i.createElement("div",{className:"theme-suggestion-card-container"},this.createCloseButton(),t.createThemeSuggestionDescription(),this.createThemeSuggestionGroup(),this.createThemeSuggestionExpandButton()))},n.createCloseButton=function(){var e=this,t=Object(a.a)().Common_Close_Text;return Object(d.a)({ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":t,className:"theme-suggestion-card-close-button",onClick:function(){e.logSuggestionEngage("close"),u.a.Resolve("IFormUserContextActionSignal").addUserActionSignal(g.a[g.a.ThemeSuggestion],5,"",!0),e.setState({ShowThemeSuggestionCard:!1},(function(){e.intelligenceSuggestionsMaster.AddDismissedSuggestion("TitleSuggestsTheme")}))},title:t},Icon:"Cancel",IconClassName:"top-view-close-icon forms-icon-size16x16",ref:"close-button"})},t.createThemeSuggestionDescription=function(){var e=Object(a.a)().Designer_Intelligence_Theme_Card_Description;return i.createElement("div",{className:"theme-suggestion-card-description"},e)},n.createThemeSuggestionGroup=function(){var e=this;if(this.state.Suggestions&&this.state.Suggestions.length>0){var t=this.state.Suggestions.map((function(t,n){return i.createElement(S.a,{applyTheme:e.props.applyTheme,IsActive:e.props.FormMaster.ThemeMaster.Model.Name===t.Name,IsFromSuggestionCard:!0,IsQuiz:e.props.FormMaster.SettingMaster.Model.IsQuizMode,key:t.Name,Theme:t})}));return i.createElement("div",{className:"theme-suggestion-card-theme-group",role:"list"},i.createElement("div",{className:"theme-suggestion-card-theme-item-large"},t[0]),i.createElement("div",{className:"theme-suggestion-card-theme-item"},t[1]),i.createElement("div",{className:"theme-suggestion-card-theme-item"},t[2]))}return null},n.createThemeSuggestionExpandButton=function(){var e=Object(a.a)().Designer_Intelligence_Theme_Card_Button_Text,t={ButtonStyle:"None",HTMLAttributes:{className:"theme-suggestion-card-expand-button",onClick:this.expandThemeFlexPane,"aria-label":e},Text:e};return i.createElement(h.a,Object(s.__assign)({},t))},n.expandThemeFlexPane=function(){var e=this;this.logSuggestionEngage("expand"),this.uxStateMaster.Model.FlexPane="Theme",this.setState({ShowThemeSuggestionCard:!1},(function(){e.intelligenceSuggestionsMaster.AddDismissedSuggestion("TitleSuggestsTheme")}))},n.onSuggestionChange=function(){var e=this;if(this.mounted){var t=this.intelligenceSuggestionsMaster.getSuggestion("TitleSuggestsTheme"),n=this.intelligenceSuggestionsMaster.ShouldPopUpSuggestion("TitleSuggestsTheme");t?this.setState({Suggestions:t.Suggestion,ShowThemeSuggestionCard:n},(function(){n&&e.intelligenceSuggestionsMaster.AddCurrentSuggestion("TitleSuggestsTheme")})):this.setState({Suggestions:[],ShowThemeSuggestionCard:!1})}},n.logSuggestionSeen=function(){this.currentSuggestionId!==this.intelligenceSuggestionsMaster.Model.SuggestionId&&(Object(c.b)("IntelligenceStatistic.ThemeSuggestionCard.Seen",{ActionSubCategory:"Show",SuggestionId:this.intelligenceSuggestionsMaster.Model.SuggestionId}),Object(c.b)("Intelligence.ThemeSuggestionCard.Seen",{ActionSubCategory:"Show"}),this.currentSuggestionId=this.intelligenceSuggestionsMaster.Model.SuggestionId)},n.logSuggestionEngage=function(e){Object(c.b)("IntelligenceStatistic.ThemeSuggestionCard.Engage",{ActionSubCategory:e,SuggestionId:this.intelligenceSuggestionsMaster.Model.SuggestionId}),Object(c.b)("Intelligence.ThemeSuggestionCard.Engage",{ActionSubCategory:e})},t}(m.a)},376:function(e,t,n){"use strict";n.r(t),n.d(t,"UserInteractionSuggestionCardV2",(function(){return T})),n.d(t,"logQuestionSuggestionSeen",(function(){return f}));var s=n(2),i=n(0),o=n(3),a=n(6),r=n(1),g=n(193),u=n(159),l=n(5),c=n(8);var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.render=function(){return i.createElement("div",{className:this.props.ClassName},i.createElement("div",{className:"common-spinner-dot common-spinner-dot1"}),i.createElement("div",{className:"common-spinner-dot common-spinner-dot2"}),i.createElement("div",{className:"common-spinner-dot common-spinner-dot3"}),i.createElement("div",{className:"common-spinner-dot common-spinner-dot4"}))},t}(c.a),h=n(17);function m(e){var t,n=i.useState(!0),s=n[0],o=n[1];i.useEffect((function(){var n=e.closeToast?e.closeToast:null;return t=window.setTimeout((function(){o(!1),n()}),e.TimerInMs),function(){window.clearTimeout(t)}}));var a="toast-control-container";e.ClassName&&(a+=" "+e.ClassName);var r="toast-control",g="toast-control-message";switch(e.ToastStyle){case"Dark":r+=" toast-control-dark",g+=" toast-control-message-dark";break;case"Light":r+=" toast-control-light",g+=" toast-control-message-light"}return s?i.createElement("div",{className:a},i.createElement("div",{className:r},i.createElement("div",{className:g},e.Message))):null}var S=n(26),p=n(246),T=function(e){function t(t){var n,s,i=e.call(this,t)||this;i.defaultSuggestionCount=6,i.newQuestionSuggestionCount=3,i.expandSuggestionCard=i.expandSuggestionCard.bind(i),i.createAddAllButton=i.createAddAllButton.bind(i),i.createCloseButton=i.createCloseButton.bind(i),i.createDotLoading=i.createDotLoading.bind(i),i.createExpandButton=i.createExpandButton.bind(i),i.createMoreSuggestionsButton=i.createMoreSuggestionsButton.bind(i),i.createToast=i.createToast.bind(i),i.closeSuggestionCard=i.closeSuggestionCard.bind(i),i.closeToast=i.closeToast.bind(i),i.loadMoreSuggestion=i.loadMoreSuggestion.bind(i),i.onSuggestionChange=i.onSuggestionChange.bind(i),i.onLoadingStateChange=i.onLoadingStateChange.bind(i),i.update=i.update.bind(i),i.getHistorySuggestionTitle=i.getHistorySuggestionTitle.bind(i),i.changeGalleryDot=i.changeGalleryDot.bind(i),i.updateSelectedSuggestion=i.updateSelectedSuggestion.bind(i),i.onInsertQuestions=i.onInsertQuestions.bind(i),i.setExpandButtonPosition=i.setExpandButtonPosition.bind(i),i.intelligenceSuggestionsMaster=Object(u.a)(i.props.Form),i.intelligenceSuggestionsMaster.registerTargetElement(i.props.InsertAfter),(null===(n=i.intelligenceSuggestionsMaster.RemainingQuestionSuggestions)||void 0===n?void 0:n.length)?s=o.clone(i.intelligenceSuggestionsMaster.RemainingQuestionSuggestions):(i.intelligenceSuggestionsMaster.MaxSuggestionCount=i.defaultSuggestionCount,s=i.getQuestionSuggestions(i.defaultSuggestionCount));var a=i.getHistorySuggestions();return i.intelligenceSuggestionsMaster.RemainingQuestionSuggestions=[],i.state={ShowToast:!1,CurrentSuggestionType:a.length>0?"HistorySuggestion":"QuestionSuggestion",HistorySuggestions:a,QuestionSuggestions:s,SelectedIndex:[],ShowSuggestionCard:i.shouldPopUpSuggestion(),ShowSuggestionLoading:!1},i}Object(s.__extends)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.intelligenceSuggestionsMaster.observe(this.onSuggestionChange,[this.intelligenceSuggestionsMaster.Schema.SuggestionId]),this.intelligenceSuggestionsMaster.observe(this.onLoadingStateChange,[this.intelligenceSuggestionsMaster.Schema.IsLoading]),this.setExpandButtonPosition()},n.componentDidUpdate=function(){this.setExpandButtonPosition()},n.componentWillUnmount=function(){window.clearTimeout(this.showSpinnerTimer),window.clearTimeout(this.showToastTimer),this.intelligenceSuggestionsMaster.unobserve(this.onSuggestionChange),this.intelligenceSuggestionsMaster.unobserve(this.onLoadingStateChange),this.intelligenceSuggestionsMaster.unregisterTargetElement(this.props.InsertAfter),this.intelligenceSuggestionsMaster.RemoveCurrentSuggestion("TitleSuggestsQuestion")},n.update=function(){this.forceUpdate()},n.render=function(){if(this.state.QuestionSuggestions.length>0||this.state.HistorySuggestions.length>0){if(this.props.InsertPaneExpanded&&this.state.ShowSuggestionCard){return this.logQuestionSuggestionSeen(),this.intelligenceSuggestionsMaster.AddCurrentSuggestion("TitleSuggestsQuestion"),i.createElement("div",{className:"form-intelligence-container office-form-theme-focus-border office-form-theme-border-top",key:"formIntelligenceCardContainer",id:"form-intelligence-question-suggestion-card",tabIndex:-1},this.createHeader(),this.createQuestionGroup(),this.createMoreSuggestionsButton(),this.createGallery())}return this.intelligenceSuggestionsMaster.RemoveCurrentSuggestion("TitleSuggestsQuestion"),this.createExpandButton()}return null},n.createHeader=function(){var e="",t=this.createAddAllButton();"HistorySuggestion"===this.state.CurrentSuggestionType?e=""===this.getHistorySuggestionTitle()?Object(r.a)().Designer_Intelligence_History_Suggest_Frequently:Object(r.a)().Designer_Intelligence_History_Suggest_Relevant.format(this.getHistorySuggestionTitle()):"QuestionSuggestion"===this.state.CurrentSuggestionType&&(e=Object(r.a)().Intelligence_Question_Suggestion_Title);var n=i.createElement("div",{className:"question-suggestion-header-text-container"},i.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),i.createElement("div",{className:"question-suggestion-header-text"},e));return i.createElement("div",{className:"question-suggestion-header-container"},n,i.createElement("div",{className:"question-suggestion-header-button-container"},i.createElement("div",{className:"form-intelligence-header-buttons"},t,this.createCloseButton())))},n.createAddAllButton=function(){var e=this.state.SelectedIndex.length>0?Object(r.a)().IntelligenceSuggestion_Add_With_Count.format(this.state.SelectedIndex.length):Object(r.a)().Designer_Intelligence_AddAll;return Object(S.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"question-suggestion-header-button-add-all",onClick:this.onInsertQuestions},Text:e})},n.createCloseButton=function(){return Object(h.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-close-button",onClick:this.closeSuggestionCard},Icon:"Cancel",IconClassName:"forms-icon-size14x14",Text:Object(r.a)().Common_Close_Text})},n.createQuestionGroup=function(){var e=this,t=("HistorySuggestion"===this.state.CurrentSuggestionType?this.state.HistorySuggestions:this.state.QuestionSuggestions).map((function(t,n){return Object(g.d)({Index:n,key:t.QuestionTagForIntelligence,Question:t,Selected:e.state.SelectedIndex.indexOf(n)>=0,updateSelectedSuggestion:e.updateSelectedSuggestion})}));return i.createElement("div",{className:"form-intelligence-user-interaction-question-group",id:"intelligence-question-suggestion-group",key:"formIntelligenceGroup",role:"group"},t,this.state.ShowSuggestionLoading&&this.createDotLoading())},n.createMoreSuggestionsButton=function(){return"QuestionSuggestion"===this.state.CurrentSuggestionType&&this.hasNewQuestionSuggestions()?Object(S.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"form-intelligence-question-suggestion-more",onClick:this.loadMoreSuggestion},Text:Object(r.a)().Intelligence_Question_Suggestion_More}):null},n.createDotLoading=function(){var e,t="";return t=this.hasNewQuestionSuggestions()?"form-intelligence-question-suggestion-loading-cover-with-more":this.intelligenceSuggestionsMaster.MaxSuggestionCount>=this.defaultSuggestionCount?"form-intelligence-question-suggestion-loading-cover":"form-intelligence-question-suggestion-loading",e={ClassName:t},i.createElement(d,e)},n.createToast=function(){var e=Object(r.a)().Intelligence_Question_Suggestion_Toast_Message,t={ClassName:"form-intelligence-question-suggestion-toast",closeToast:this.closeToast,Message:e,TimerInMs:3500,ToastStyle:"Dark"};return i.createElement(m,Object(s.__assign)({},t))},n.createExpandButton=function(){var e=this.props.InsertPaneExpanded?"form-intelligence-header-expand-button form-intelligence-header-expand-button-right":"form-intelligence-header-expand-button form-intelligence-header-expand-button-left",t=Object(h.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-expanded":!1,className:"form-intelligence-header-expand-button-icon",onClick:this.expandSuggestionCard},Icon:"LightningBolt",IconClassName:"forms-icon-size16x16",Text:Object(r.a)().Intelligence_Question_Suggestion_Expand_Button_Label});return i.createElement("div",{className:e,onClick:this.expandSuggestionCard},t)},n.closeToast=function(){this.setState({ShowToast:!1})},n.closeSuggestionCard=function(){this.intelligenceSuggestionsMaster.AddDismissedSuggestion("TitleSuggestsQuestion"),this.setState({ShowSuggestionCard:!1})},n.expandSuggestionCard=function(){this.intelligenceSuggestionsMaster.AddCurrentSuggestion("TitleSuggestsQuestion"),this.setState({ShowSuggestionCard:!0}),this.props.expandInsertPane()},n.loadMoreSuggestion=function(){var e=this;window.clearTimeout(this.showSpinnerTimer),this.setState({ShowSuggestionLoading:!0},(function(){e.showSpinnerTimer=window.setTimeout((function(){e.intelligenceSuggestionsMaster.MaxSuggestionCount+=e.newQuestionSuggestionCount;var n=e.refreshQuestionSuggestions();e.setState({QuestionSuggestions:n,ShowSuggestionLoading:!1,ShowToast:!0},(function(){t.autoScrollDown()}))}),1e3)}))},n.onInsertQuestions=function(){var e,t,n=this,s=this.props.Form.FormElementManager,i=this.props.InsertAfter,a="HistorySuggestion"===this.state.CurrentSuggestionType?this.state.HistorySuggestions:this.state.QuestionSuggestions,r=[];if("HistorySuggestion"===this.state.CurrentSuggestionType?r=this.intelligenceSuggestionsMaster.getSuggestion("HistoryFormSuggestion").Suggestion.Result.Questions:"QuestionSuggestion"===this.state.CurrentSuggestionType&&(r=this.intelligenceSuggestionsMaster.SubQuestionCollection),this.state.SelectedIndex.length>0){var g=this.state.SelectedIndex;g.sort((function(e,t){return e-t})),t=g.map((function(e){return a[e]}))}else t=a;if(t=t.filter((function(e){return!!e})),i||"Title"===i){t.reverse();var u="Title"===i?null:i;e=function(e,t){return s.insertElementAfter(e,u,t)}}else e=function(e,t){return s.appendElement(e,t)};var l=!1,c=null;t.forEach((function(t){var n;"Question.MatrixChoiceGroup"===(t=o.clone(t)).Type&&(n=r.filter((function(e){return e.GroupId===t.Id})).map((function(e){var t=o.clone(e);return delete t.Id,t}))),delete t.Id,!i||l?e(t,n):(c=e(t,n),l=!0)}));var d=[];"QuestionSuggestion"===this.state.CurrentSuggestionType&&(d=this.state.QuestionSuggestions.filter((function(e){return!o.find(t,(function(t){return t.Title===e.Title||t.QuestionTagForIntelligence===e.QuestionTagForIntelligence}))})),this.intelligenceSuggestionsMaster.MaxSuggestionCount+=t.length*(this.newQuestionSuggestionCount-1),this.intelligenceSuggestionsMaster.RemainingQuestionSuggestions=d),this.logQuestionSuggestionKept(),this.setState({HistorySuggestions:[],SelectedIndex:[],QuestionSuggestions:d},(function(){n.props.designElement&&n.props.designElement(c),n.props.expandInsertPane()}))},n.onSuggestionChange=function(){var e=this.state.QuestionSuggestions.length,n=this.refreshQuestionSuggestions(),s="QuestionSuggestion"===this.state.CurrentSuggestionType&&n.length>e&&e>this.defaultSuggestionCount,i=this.getHistorySuggestions();this.setState({CurrentSuggestionType:i.length>0?"HistorySuggestion":"QuestionSuggestion",ShowSuggestionCard:this.shouldPopUpSuggestion(),HistorySuggestions:i,QuestionSuggestions:n,ShowToast:s},(function(){t.autoScrollDown()}))},n.onLoadingStateChange=function(){var e="QuestionSuggestion"===this.state.CurrentSuggestionType&&!1===this.state.ShowToast&&this.intelligenceSuggestionsMaster.Model.IsLoading;this.setState({ShowSuggestionLoading:e})},n.shouldPopUpSuggestion=function(){return this.intelligenceSuggestionsMaster.ShouldPopUpSuggestion("TitleSuggestsQuestion")},n.getHistorySuggestions=function(){var e,t=[],n=null===(e=this.intelligenceSuggestionsMaster.getSuggestion("HistoryFormSuggestion"))||void 0===e?void 0:e.Suggestion;0===this.props.Form.Model.Questions.length&&n&&n.Result&&n.Result.Questions&&(t=a.a.convertToArray(n.Result.Questions).filter((function(e){return"Question.MatrixChoice"!==e.Type})));return null!=t?t:[]},n.getHistorySuggestionTitle=function(){var e,t="",n=null===(e=this.intelligenceSuggestionsMaster.getSuggestion("HistoryFormSuggestion"))||void 0===e?void 0:e.Suggestion;switch(n.SuggestionType||-1){case 2:case 1:t=n.Result.Title}return t},n.hasNewQuestionSuggestions=function(){return this.getQuestionSuggestions(this.intelligenceSuggestionsMaster.MaxSuggestionCount+this.newQuestionSuggestionCount).length>this.state.QuestionSuggestions.length},n.refreshQuestionSuggestions=function(){return this.getQuestionSuggestions(this.intelligenceSuggestionsMaster.MaxSuggestionCount)},n.getQuestionSuggestions=function(e){var t,n,s,i=null!==(n=null===(t=this.intelligenceSuggestionsMaster.getSuggestion("TitleSuggestsQuestion"))||void 0===t?void 0:t.Suggestion)&&void 0!==n?n:[];if(0===i.length)return[];var r=a.a.convertToArray(this.props.Form.Model.Questions),g=null!==(s=this.state.QuestionSuggestions)&&void 0!==s?s:[],u=i.filter((function(e){var t=!o.find(r,(function(t){return t.Title===e.Title||t.QuestionTagForIntelligence===e.QuestionTagForIntelligence})),n=!o.find(g,(function(t){return t.Title===e.Title||t.QuestionTagForIntelligence===e.QuestionTagForIntelligence}));return t&&n})),l=e-g.length,c=g.concat(u.slice(0,l));return null!=c?c:[]},n.createGallery=function(){if(this.state.HistorySuggestions.length>0&&this.state.QuestionSuggestions.length>0)return i.createElement("div",{className:"question-suggestion-card-gallery"},i.createElement("div",{className:"question-suggestion-card-gallery-dots-container"},i.createElement(p.a,{changeGalleryDot:this.changeGalleryDot,Index:0,key:0,Selected:"HistorySuggestion"===this.state.CurrentSuggestionType}),i.createElement(p.a,{changeGalleryDot:this.changeGalleryDot,Index:1,key:1,Selected:"QuestionSuggestion"===this.state.CurrentSuggestionType})))},n.changeGalleryDot=function(e){this.setState({SelectedIndex:[]}),0===e?this.setState({CurrentSuggestionType:"HistorySuggestion"}):1===e&&this.setState({CurrentSuggestionType:"QuestionSuggestion"})},n.updateSelectedSuggestion=function(e,t){var n=this.state.SelectedIndex,s=n.indexOf(e);s>=0&&t?n.splice(s,1):n.push(e),this.setState({SelectedIndex:n})},n.logQuestionSuggestionSeen=function(){var e,t;this.currentSuggestionId!==this.intelligenceSuggestionsMaster.Model.SuggestionId&&(Object(l.b)("IntelligenceStatistic.QuestionSuggestion.Seen",{ActionSubCategory:"Show",SuggestionId:this.intelligenceSuggestionsMaster.Model.SuggestionId}),Object(l.b)("Intelligence.QuestionSuggestion.Seen",{ActionSubCategory:"Show",HasHistorySuggestion:(null===(e=this.state.HistorySuggestions)||void 0===e?void 0:e.length)>0,HasQuestionSuggestion:(null===(t=this.state.QuestionSuggestions)||void 0===t?void 0:t.length)>0}),this.currentSuggestionId=this.intelligenceSuggestionsMaster.Model.SuggestionId)},n.logQuestionSuggestionKept=function(){Object(l.b)("IntelligenceStatistic.QuestionSuggestion.Kept",{ActionSubCategory:"Choose",SuggestionId:this.intelligenceSuggestionsMaster.Model.SuggestionId}),Object(l.b)("Intelligence.QuestionSuggestion.Kept",{ActionSubCategory:"Choose",IsHistorySuggestion:"HistorySuggestion"===this.state.CurrentSuggestionType})},t.autoScrollDown=function(){var e=document.getElementById("intelligence-question-suggestion-group");if(e&&e.scrollHeight>e.offsetHeight){var t=$("#intelligence-question-suggestion-group");t&&t.animate({scrollTop:e.scrollHeight},500)}},n.setExpandButtonPosition=function(){var e=$(".design-view-insert-panel-expand-or-collapse");if(e.length){var t=e.width(),n=$(".form-intelligence-header-expand-button");if(n.length&&t)if(this.props.InsertPaneExpanded)n[0].style.marginLeft="0";else{n[0].style.marginLeft=t+8+"px"}}},t}(c.a);function f(e,t){if(e&&e.length>0&&t){Object(l.b)("Intelligence."+t.Feature+".Seen",{ActionSubCategory:"Show",DetectedLanguage:t.DetectedLang,Feature:t.Feature,ModelName:t.ModelName,Variation:t.Variation});var n=[];n.push(e.map((function(e){return e.Id})));var s=t.ExtraData;s&&s.Scores&&(s.Scores=[]),Object(l.b)("IntelligenceStatistic."+t.Feature+".Seen",{ActionSubCategory:"Show",DetectedLanguage:t.DetectedLang,ExtraData:s,Feature:t.Feature,ModelName:t.ModelName,QuestionIds:n,SuggestionId:t.SuggestionId,Variation:t.Variation},null,!0)}}}}]);